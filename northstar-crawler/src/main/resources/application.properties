# NorthStar Crawler - Search Provider Configuration
# This is a TEMPLATE file. Actual API keys should be in application-prod.properties (gitignored)

# BraveSearch Configuration
search.providers.brave-search.api-key=${BRAVE_API_KEY:}
search.providers.brave-search.base-url=https://api.search.brave.com/res/v1/web/search
search.providers.brave-search.timeout=5000
search.providers.brave-search.max-results=20
search.providers.brave-search.rate-limit.daily=50

# Serper (Google Search API) Configuration
search.providers.serper.api-key=${SERPER_API_KEY:}
search.providers.serper.base-url=https://google.serper.dev/search
search.providers.serper.timeout=5000
search.providers.serper.max-results=20
search.providers.serper.rate-limit.daily=60

# Perplexica (AI-optimized) Configuration
search.providers.perplexica.api-key=${PERPLEXICA_API_KEY:}
search.providers.perplexica.base-url=https://api.perplexica.com/search
search.providers.perplexica.timeout=6000
search.providers.perplexica.max-results=20
search.providers.perplexica.search-depth=advanced
search.providers.perplexica.rate-limit.daily=25

# SearXNG (Self-hosted) Configuration
search.providers.searxng.base-url=http://192.168.1.10:8080/search
search.providers.searxng.timeout=7000
search.providers.searxng.max-results=20
search.providers.searxng.format=json
# No rate limit (self-hosted)

# Timeout Configuration
search.timeouts.per-provider=5000
search.timeouts.total-search=10000

# ============================================================================
# Resilience4j Configuration
# ============================================================================

# Retry Configuration (exponential backoff)
resilience4j.retry.instances.searchProvider.max-attempts=3
resilience4j.retry.instances.searchProvider.wait-duration=500ms
resilience4j.retry.instances.searchProvider.exponential-backoff-multiplier=2
resilience4j.retry.instances.searchProvider.retry-exceptions=java.io.IOException,java.net.http.HttpTimeoutException

# Rate Limiter Configuration - BraveSearch (50 requests per day)
resilience4j.ratelimiter.instances.braveSearch.limit-for-period=50
resilience4j.ratelimiter.instances.braveSearch.limit-refresh-period=24h
resilience4j.ratelimiter.instances.braveSearch.timeout-duration=1ms

# Rate Limiter Configuration - Serper (60 requests per day)
resilience4j.ratelimiter.instances.serper.limit-for-period=60
resilience4j.ratelimiter.instances.serper.limit-refresh-period=24h
resilience4j.ratelimiter.instances.serper.timeout-duration=1ms

# Rate Limiter Configuration - Perplexica (25 requests per day)
resilience4j.ratelimiter.instances.perplexica.limit-for-period=25
resilience4j.ratelimiter.instances.perplexica.limit-refresh-period=24h
resilience4j.ratelimiter.instances.perplexica.timeout-duration=1ms

# Rate Limiter Configuration - SearXNG (unlimited, self-hosted)
resilience4j.ratelimiter.instances.searxng.limit-for-period=999999
resilience4j.ratelimiter.instances.searxng.limit-refresh-period=24h
resilience4j.ratelimiter.instances.searxng.timeout-duration=1ms

# Circuit Breaker Configuration (optional, disabled by default)
# Uncomment to enable circuit breaker for flaky providers
# resilience4j.circuitbreaker.instances.searchProvider.sliding-window-size=10
# resilience4j.circuitbreaker.instances.searchProvider.failure-rate-threshold=50
# resilience4j.circuitbreaker.instances.searchProvider.wait-duration-in-open-state=30s
